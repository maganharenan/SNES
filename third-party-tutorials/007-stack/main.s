; ==========================================================================
; Assembler Directives
; ==========================================================================
.p816
.i16
.a8

; ==========================================================================
; Initialization
; ==========================================================================
.segment "CODE"
.proc   ResetHandler
        sei
        clc
        xce

        lda     #$81
        sta     $4200 

        rep     #$10
        sep     #$20

        ldx     #$1212
        ldy     #$cccc
        jsr     AddXtoY
        
        jmp     GameLoop
.endproc

; ==========================================================================
; Game Loop
; ==========================================================================
.proc   GameLoop
        wai
        jmp     GameLoop
.endproc

; ==========================================================================
; NMI Handler
; ==========================================================================
.proc   NMIHandler
        lda     $4210
        rti
.endproc

.proc AddXtoY
        rep     #$20
        phx
        tya
        clc
        adc     $01, S
        tay
        plx
        rts
.endproc

; ==========================================================================
; Footer
; ==========================================================================
.segment "VECTOR"
; native mode   COP,        BRK,        ABT,
.addr           $0000,      $0000,      $0000
;               NMI,        RST,        IRQ
.addr           NMIHandler, $0000,      $0000

.word           $0000, $0000    ; four unused bytes

; emulation m.  COP,        BRK,        ABT,
.addr           $0000,      $0000,      $0000
;               NMI,        RST,        IRQ
.addr           $0000 ,     ResetHandler, $0000